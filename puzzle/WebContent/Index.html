<!DOCTYPE html>
<html>
<head>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">

<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

<!-- Popper JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>

<!-- Latest compiled JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
<meta charset="UTF-8">
<title>Home</title>
</head>
<script src="/puzzle/scripts/jquery-3.4.1.min.js"></script>
<body>

		<!-- 
			select * from report 
			order by timer asc, count asc
			
			[Top10]
			limit 10
			
			[Today Top10]
			where ë‚ ì§œí•¨ìˆ˜(report_date) == ë‚ ì§œí•¨ìˆ˜(now())
			limit 10 
			 
			[ToMonth Top10]
			where
			 
		    [My Report List]
		    where member_id=?
		    									-->
	<div><h2 align="center">ğŸ™ŒHello! Player : <span id="LoginState"></span></h2></div>
	<button id="always" class="btn btn-secondary">ğŸ‘Top 10</button>
	<button id="today" class="btn btn-secondary">ğŸ‘Today Top 10</button>
	<button id="month" class="btn btn-secondary">ğŸ‘ToMonth Top 10</button>
	
	<!-- ë¡œê·¸ì¸ ì „ -->

	<button id="loginBtn" class="btn btn-secondary">ğŸ”’Login</button>
	<button id="signUpBtn" class="btn btn-secondary">ğŸ›«Sign Up</button> <!-- í´ë¦­ ì‹œ localtion.href ="signUp.html" -->

	<!-- ë¡œê·¸ì¸ í›„ -->
	<button id="game" class="btn btn-secondary">ğŸ²Play Game</button>
	<button id="logoutBtn" class="btn btn-secondary">ğŸ”ŒLogOut</button>
	<button id="reportBtn" class="btn btn-secondary">âš”ï¸My Report List</button>
	<button id="editPwBtn" class="btn btn-secondary">âœï¸Edit Password</button>
	<button id="outBtn" class="btn btn-secondary">âŒWithdrawal</button>
	
	<table id="list" border="1">

	</table>
</body>

<script>
	$(document).ready(function(){
//--------------------------------------------------------------------------------------------------------------ì„¸ì…˜------------------------------------------------------------------------------------------------------ 
		let loginState = null;
			//sessionInfoê°’ì„ ë™ê¸°ë¡œ ìš”ì²­
		$.ajax({
			url :"/puzzle/GetSessionInfo",
			method :"post",
			async : false, // ë™ê¸°ìš”ì²­
			success : function(json){
				loginState = json;
				console.log("loginState : "+ loginState)
			}
		});
			//ë§Œì•½ ë¡œê·¸ì¸í•˜ì§€ ì•Šì•˜ë‹¤ë©´.    
		if(loginState == null){
			$("#game").hide();
			$("#logoutBtn").hide();
			$("#reportBtn").hide();
			$("#editPwBtn").hide();
			$("#outBtn").hide();
			
		}else {
			$("#loginBtn").hide();
			$("#signUpBtn").hide();
		}
//--------------------------------------------------------------------------------------------------------------ë­í‚¹---------------------------------------------------------------------------------------------	---
			//ì´ë²ˆë‹¬ ë­í‚¹
	$("#month").click(function(){
		$.ajax({
			url :"/puzzle/MonthTopTen",
			method :"post",
			success : function(json){
				$("#list").empty();
				console.log(json);
				$(json).each(function(index, item){
					temp = "<thead><tr><th>reportId";
					temp += "</th><th>memberID";
					temp += "</th><th>reportDate";
					temp += "</th><th>Count";
					temp += "</th><th>Timer";
					temp += "</th></thead>";
					temp += "<tbody><tr><td>"+item.reportId;
					temp += "</td><td>"+item.member.memberId;
					temp += "</td><td>"+item.reportDate;
					temp += "</td><td>"+item.count;
					temp += "</td><td>"+item.timer;
					temp += "</td></tr></tbody>";
					$("#list").append(temp);
				});
			}
		});
	});
	
			//ì˜¤ëŠ˜ ë­í‚¹
	$("#today").click(function(){
		$.ajax({
			url :"/puzzle/TodayTopTen",
			method :"post",
			success : function(json){
				$("#list").empty();
				console.log(json);
				$(json).each(function(index, item){
					temp = "<thead><tr><th>reportId";
					temp += "</th><th>memberID";
					temp += "</th><th>reportDate";
					temp += "</th><th>Count";
					temp += "</th><th>Timer";
					temp += "</th></thead>";
					temp += "<tbody><tr><td>"+item.reportId;
					temp += "</td><td>"+item.member.memberId;
					temp += "</td><td>"+item.reportDate;
					temp += "</td><td>"+item.count;
					temp += "</td><td>"+item.timer;
					temp += "</td></tr></tbody>";
					$("#list").append(temp);
				});
			}
		});
	});
	
			//ì—­ëŒ€ ë­í‚¹
	$("#always").click(function(){
		$.ajax({
			url :"/puzzle/TopTenList",
			method :"post",
			success : function(json){
					$("#list").empty();
				console.log(json);
				$(json).each(function(index, item){
					temp = "<thead><tr><th>reportId";
					temp += "</th><th>memberID";
					temp += "</th><th>reportDate";
					temp += "</th><th>Count";
					temp += "</th><th>Timer";
					temp += "</th></thead>";
					temp += "<tbody><tr><td>"+item.reportId;
					temp += "</td><td>"+item.member.memberId;
					temp += "</td><td>"+item.reportDate;
					temp += "</td><td>"+item.count;
					temp += "</td><td>"+item.timer;
					temp += "</td></tr></tbody>";
					$("#list").append(temp);
				});
			}
		});
	});

//--------------------------------------------------------------------------------------------------------------ë²„íŠ¼-----------------------------------------------------------------------------------------------------	
			//ìƒë‹¨ ë¡œê·¸ì¸ ì •ë³´ í‘œì‹œ
	$("#LoginState").text(loginState);
		
			//ê²Œì„
	$("#game").click(function(){
		location.href = "/puzzle/Puzzle.html";
	});
	
			//ë¡œê·¸ì¸
	$("#loginBtn").click(function(){
		location.href = "/puzzle/login.html";
	});
	
			//ë¡œê·¸ì•„ì›ƒ
	$("#logoutBtn").click(function(){
		$.ajax({
			url : "/puzzle/Logout",
			method : "post",
			success : function(){
				console.log("ë¡œê·¸ì•„ì›ƒ");
				location.href = "/puzzle/Index.html";
			}
		});
	});
	
			//íšŒì›ê°€ì…
	$("#signUpBtn").click(function(){
		location.href = "/puzzle/signUp.html";
	});
			
			//ë‚´ ê¸°ë¡
	$("#reportBtn").click(function(){
		$.ajax({
			url :"/puzzle/MyRanking",
			method :"post",
			success : function(json){
					$("#list").empty();
				console.log(json);
				$(json).each(function(index, item){
					temp = "<thead><tr><th>reportId";
					temp += "</th><th>memberID";
					temp += "</th><th>reportDate";
					temp += "</th><th>Count";
					temp += "</th><th>Timer";
					temp += "</th></thead>";
					temp += "<tbody><tr><td>"+item.reportId;
					temp += "</td><td>"+item.member.memberId;
					temp += "</td><td>"+item.reportDate;
					temp += "</td><td>"+item.count;
					temp += "</td><td>"+item.timer;
					temp += "</td></tr></tbody>";
					$("#list").append(temp);
				});
			}
		});
	});
	
			//íšŒì›ìˆ˜ì •
	$("#editPwBtn").click(function(){
		location.href="/puzzle/editMember.html";
	});
	
			//íšŒì› íƒˆí‡´
	$("#outBtn").click(function(){
		location.href = "/puzzle/userOut.html";
	});
	});
</script>

</html>